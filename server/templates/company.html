{% extends "layout.html" %}
{% block content %}
<br>
  <article class="media content-section">
    <script src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.6/Chart.min.js'></script>
    <div class="media-body">
      <div class="article-metadata">
        <h2 class="mc-2">{{company.name}}</h2>
      </div>
      <ul class="nav nav-tabs">
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#analysis">Analysis</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#profile">Profile</a>
        </li>
      </ul>
      <div id="myTabContent" class="tab-content">
        <div class="tab-pane fade" id="analysis">
            <div class='container-fluid'>
            <br>
            <div class="chart-container" style="position: relative; height:40vh; width:80vw">
              <h4>Graphical Analysis</h4>  
              <canvas id="line-chart"></canvas>
            </div>
              <script>
              new Chart(document.getElementById("line-chart"), {
                  type: 'line',
                  data: {
                      labels: [{% for item in timeseries_labels %}
                          "{{ item }}",
                          {% endfor %}],
                      datasets: [{ 
                          data:[{% for item in timeseries_values %}
                                "{{ item }}",
                                {% endfor %}],
                          label: "User",
                          borderColor: "#3e95cd",
                          fill: false
                      }
                      ]
                  },
                  options: {
                      title: {
                      display: true,
                      text: 'Total Amount of Analysis Made'
                      },
                      elements: {
                          line: {
                              tension: 0 // disables bezier curves
                          }
                      }
                  }
                  });
              </script>  
              </div>
              <br>
        </div>
        <div class="tab-pane fade active show" id="profile">
            <div class='container-fluid'>
                    <form method="POST" action="" enctype="multipart/form-data">
                        {{ form.hidden_tag() }}
                        <fieldset>
                            <legend class="border-bottom mb-3">Account Information</legend>
                            <div class="form-group">
                                {{ form.name.label(class="form-control-label") }}
                                {% if form.name.errors %}
                                    {{ form.name(class="form-control form-control-lg is-invalid") }}
                                    <div class="invalid-feedback">
                                      {% for error in form.name.errors %}
                                        <span>{{ error }}</span>
                                      {% endfor %}
                                    </div>
                                {% else %}
                                  {{ form.name(class="form-control form-control-lg") }}
                                {% endif %}
                            </div>
                            <div class="form-group">
                              {{ form.address.label(class="form-control-label") }}
                              {% if form.address.errors %}
                                {{ form.address(class="form-control form-control-lg is-invalid") }}
                                <div class="invalid-feedback">
                                  {% for error in form.address.errors %}
                                    <span>{{ error }}</span>
                                  {% endfor %}
                                </div>
                              {% else %}
                                {{ form.address(class="form-control form-control-lg") }}
                              {% endif %}
                            </div>
                            <div class="form-group">
                              {{ form.city.label(class="form-control-label") }}
                              {% if form.city.errors %}
                                {{ form.city(class="form-control form-control-lg is-invalid") }}
                                <div class="invalid-feedback">
                                  {% for error in form.city.errors %}
                                    <span>{{ error }}</span>
                                  {% endfor %}
                                </div>
                              {% else %}
                                {{ form.city(class="form-control form-control-lg") }}
                              {% endif %}
                            </div>
                            <div class="form-group">
                              {{ form.country.label(class="form-control-label") }}
                              {% if form.country.errors %}
                                {{ form.country(class="form-control form-control-lg is-invalid") }}
                                <div class="invalid-feedback">
                                  {% for error in form.country.errors %}
                                    <span>{{ error }}</span>
                                  {% endfor %}
                                </div>
                              {% else %}
                                {{ form.country(class="form-control form-control-lg") }}
                              {% endif %}
                            </div>
                            <div class="form-group">
                              {{ form.telephone.label(class="form-control-label") }}
                              {% if form.telephone.errors %}
                                {{ form.telephone(class="form-control form-control-lg is-invalid") }}
                                <div class="invalid-feedback">
                                  {% for error in form.telephone.errors %}
                                    <span>{{ error }}</span>
                                  {% endfor %}
                                </div>
                              {% else %}
                                {{ form.telephone(class="form-control form-control-lg") }}
                              {% endif %}
                            </div>
                            <div>
                              <span class="custom-text" id ="image-text1">Select a image file</span>
                            </div> 
                            <div class="form-group">
                              <div class="input-group mb-3" id = 'upload-button1'>
                                  <div class="custom-file">
                                      {{form.picture(class="custom-file-input", id="input_image1") }}
                                      {{form.picture.label(class="custom-file-label", for="input_image1")}}
                                      {% if form.picture.errors %}
                                          <div class="invalid-feedback">
                                              {% for error in form.picture.errors %}
                                                  <span class="text-danger">{{ error }}</span>
                                              {% endfor %}
                                          </div>
                                      {% endif %}
                                  </div>
                              </div>
                            </div>
                            <script type="text/javascript">
                              const realFileBtn1 = document.getElementById("input_image1");
                              const customBtn1 = document.getElementById("upload-button1");
                              const customTxt1 = document.getElementById("image-text1");
                              realFileBtn1.addEventListener("change", function() {
                              if (realFileBtn1.value) {
                                  customTxt1.innerHTML = realFileBtn1.value.match(
                                  /[\/\\]([\w\d\s\.\-\(\)]+)$/
                                  )[1];
                              } else {
                                  customTxt1.innerHTML = "Select a image file";
                              }
                              });            
                            </script>
                        </fieldset>
                      </fieldset>
                        <button type="submit" class="btn btn-secondary btn-lg btn-block">Submit</button>
                      </fieldset>
                    </form>
            </div>
          <br> 
       </div>
      </div>
      <br>
  </article>

{% endblock content %}


